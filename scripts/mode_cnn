import keras
from keras.models import load_model
import tensorflow as tf
import os
import glob
import csv
import math
from pathlib import Path
import numpy as np
from PIL import Image
from PIL.ExifTags import TAGS
import cv2
import pickle 
import requests
import sys
print("Successful import!")

model_file = "mobilenet_7_5_224_tf_no_top.h5"
model=tf.keras.models.load_model(model_file)
config=model.get_config()
weights=model.get_weights()
image_path='/home/pi/cameratrap/data/deer_train/Deer_Test0.jpg'

def imageAdder(path_in):
  path= path_in
  image=cv2.imread(path)
  image2= cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
  img=cv2.resize(image, (224,224))
  return img
  
img=imageAdder(image_path)
img=img/255

def predictor(image):
  test_image_batch=image
  test_image_batch=test_image_batch.reshape(1, 224, 224, 3)
  preds= model.predict_classes(test_image_batch, batch_size=1)
  probs= model.predict(test_image_batch, batch_size=1)
  print(preds)


predictor(img)
